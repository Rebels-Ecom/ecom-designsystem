<!-- dialog.stories.mdx -->

import { useState, useRef } from 'react'
import { Canvas, Meta, Story } from '@storybook/addon-docs'

import { Dialog } from './dialog'
import { Button } from '../../atoms/button/button'
import { FormGroup } from '../../molecules/form-group/form-group'
import { InputText, Textarea } from '../../atoms'

<Meta title="MDX/Dialog" component={Dialog} />

export const Template = (args) => {
  const [isOpen, setIsOpen] = useState(false)
  const buttonRef = useRef(null)
  const insideFocusModalRef = useRef(null)
  function onClose() {
    setIsOpen(false)
    buttonRef?.current?.focus()
  }
  function onOpen() {
    setIsOpen(true)
  }
  return (
    <div>
      <Button type="button" surface="primary" onClick={onOpen} ref={buttonRef}>
        Open Modal
      </Button>
      <Dialog {...args} isOpen={isOpen} onClose={onClose} focusableElementInside={insideFocusModalRef} surface="light" className={'light'}>
        <h2 className="h3" style={{ marginTop: 0 }}>
          We value your opinion
        </h2>
        <FormGroup
          label={'What is your favourite cinema visit through all times?'}
          formElement={InputText}
          formElementProps={{ id: 'input1', value: '', onChange: () => {} }}
          ref={insideFocusModalRef}
        />
        <div style={{ marginTop: '2rem' }}>
          <span style={{ marginRight: '2rem' }}>
            <Button type="submit" surface="primary" size="small">
              Submit
            </Button>
          </span>
          <Button type="button" surface="secondary" size="small" onClick={onClose}>
            Close
          </Button>
        </div>
      </Dialog>
    </div>
  )
}

# Dialog

A component that's used for different types of Dialogs (modals), Alerts or AlertDialogs.

## Props

The property `role` can be set to `dialog, alert or alertDialog`. That is the definition of what kind of dialog is being used
for accessability reasons. If the Dialog is just to inform a user of a certain message for example connection issues then you use `alert`.
If the message requires an action from the user for example "Are you sure you want to delete this account? yes or cancel.
Then you set `alertDialog`. If the message is more of a delight information or action (clicked a button) was
requested by the user it should be set to `dialog`.

The properties `ariaLabelledBy and ariaDescribedBy` is optional but is also advised to use for accessability reasons. Should be
the same as the contents heading or if it contains a message. You set it on both heading, and or a paragraph and the Dialog.

You can provide a certain element you want to start having the focus for example a field in a form with
the property `focusableElementInside` with useRef.

## Behavior

When the dialog is open the focus stays within the dialog. As soon as you close it, the focus or taborder gets back to the button
that initiated the dialog. If `focusableElementInside` is not set it will take the first available focusable item and add the focus there.

You can close the modal by pressing the default close button, adding additional closebuttons as content / children,
press esc or click outside the content aria.

## Dialog content style

The style of the dialog is either light or dark, with padding or no padding.

<Canvas>
  <Story
    name="Dialog"
    args={{
      role: 'dialog',
      hasOverlay: true,
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>
