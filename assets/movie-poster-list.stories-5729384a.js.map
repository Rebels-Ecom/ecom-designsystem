{"version":3,"file":"movie-poster-list.stories-5729384a.js","sources":["../../src/design-system/hooks/useScrollLeft.ts","../../src/helpers/link-helper.ts","../../src/helpers/session-storage-helper.ts","../../src/design-system/components/molecules/movie-poster-list/movie-poster-list.tsx","../../src/design-system/components/molecules/movie-poster-list/movie-poster-list.stories.tsx"],"sourcesContent":["import { useLayoutEffect, useState } from 'react';\r\n\r\nexport default function useScrollLeft(ref:React.RefObject<HTMLElement>,initialPosition=0) {\r\n  const [scrollPosition, setPosition] = useState(initialPosition);\r\n    \r\n  useLayoutEffect(() => {\r\n    function updatePosition() {\r\n        if(ref && ref.current){\r\n            setPosition(ref.current.scrollLeft);\r\n        }\r\n    }\r\n\r\n    if(ref && ref.current){\r\n        ref.current.addEventListener('scroll', updatePosition);\r\n    }\r\n\r\n    updatePosition();\r\n\r\n    return () => {\r\n        if(ref && ref.current){\r\n            ref.current.removeEventListener('scroll', updatePosition);\r\n        }\r\n    }\r\n  }, []);\r\n\r\n  return scrollPosition;\r\n}","export type TLink = {\r\n  href: string\r\n  text?: string\r\n  title: string\r\n  isExternal?: boolean\r\n  target?: string\r\n}\r\n\r\n/*\r\n TODO: Hämta från types efter merge från Sofies incheckning\r\n*/\r\n\r\nfunction isExternalLink(link: TLink): boolean {\r\n  return !!(link.href && link.isExternal)\r\n}\r\n\r\nfunction isInternalLink(link: TLink, linkComponent: any): boolean {\r\n  return !!(link.href && linkComponent)\r\n}\r\n\r\nexport { isExternalLink, isInternalLink }","function setItemSessionStorage(key: string, value: any, timestamp?: any): void {\r\n    if (!key || !value) { return; }\r\n\r\n    if (timestamp) {\r\n        value = { value: value, sessionStorageItemValidUntil: timestamp };\r\n    }\r\n\r\n    if (typeof value === \"object\") {\r\n        value = JSON.stringify(value);\r\n    }\r\n\r\n    sessionStorage.setItem(key, value);\r\n}\r\n\r\nfunction isTimeStampValid(timestamp: any): boolean {\r\n    let now = new Date();\r\n    return timestamp >= (now.setMinutes(now.getMinutes()));\r\n}\r\n\r\nfunction getItemSessionStorage(key: string): any {\r\n    let value: any = sessionStorage.getItem(key);\r\n    if (!value) { return; }\r\n    if (value[0] === \"{\" || value[0] === \"[\") {\r\n        value = JSON.parse(value);\r\n    }\r\n\r\n    if (value && !value[\"sessionStorageItemValidUntil\"]) {\r\n        return value;\r\n    }\r\n\r\n    return valueTimeStampValidation(value, key);\r\n}\r\n\r\nfunction valueTimeStampValidation(value: any, key: string): undefined | any {\r\n    if (isTimeStampValid(value[\"sessionStorageItemValidUntil\"])) {\r\n        return value.value;\r\n    } else {\r\n        removeItemSessionStorage(key);\r\n        return undefined;\r\n    }\r\n}\r\n\r\nfunction removeItemSessionStorage(key: string): void {\r\n    sessionStorage.removeItem(key);\r\n}\r\n\r\nexport { setItemSessionStorage, getItemSessionStorage, removeItemSessionStorage }\r\n","import React, { useRef, useEffect } from 'react'\r\nimport { MoviePoster } from '../../atoms/movie-poster/movie-poster'\r\nimport { IPicture } from '../../atoms/picture/picture'\r\nimport { TLink, isExternalLink, isInternalLink } from '../../../../helpers/link-helper'\r\nimport useScrollLeft from '../../../hooks/useScrollLeft'\r\nimport { getItemSessionStorage, setItemSessionStorage } from '../../../../helpers/session-storage-helper'\r\nimport styles from './movie-poster-list.module.css'\r\n\r\nexport interface IMoviePosterList {\r\n  heading?: string\r\n  preamble?: React.ReactNode | string\r\n  list: Array<IMoviePosterListItem>\r\n  linkComponent?: any\r\n  listSessionId?: string\r\n}\r\n\r\nexport interface IMoviePosterListItem {\r\n  image: IPicture\r\n  heading?: string\r\n  preamble?: string\r\n  link?: TLink\r\n}\r\n\r\nfunction getInitialScrollLeft(sessionStorageId: string = ''): number {\r\n  const scrollLeftPosition = typeof window !== 'undefined' && sessionStorageId ? getItemSessionStorage(sessionStorageId) : 0\r\n  return scrollLeftPosition ? scrollLeftPosition : 0\r\n}\r\n\r\nconst MoviePosterList = ({ heading, preamble, list = [], linkComponent: Link, listSessionId }: IMoviePosterList) => {\r\n  const listRef = useRef<HTMLUListElement>(null)\r\n  const scrollLeft = useScrollLeft(listRef, getInitialScrollLeft(listSessionId))\r\n\r\n  useEffect(() => {\r\n    if (listRef?.current) {\r\n      listRef.current.scrollLeft = scrollLeft ? scrollLeft : 0\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (listSessionId) {\r\n      setItemSessionStorage(listSessionId, scrollLeft)\r\n    }\r\n  }, [scrollLeft])\r\n\r\n  function renderMoviePoster(li: IMoviePosterListItem) {\r\n    if (li?.link && isExternalLink(li.link)) {\r\n      return (\r\n        <a href={li.link.href} target={li.link.target} title={li.link.title} className={styles.link}>\r\n          <MoviePoster {...li.image} />\r\n        </a>\r\n      )\r\n    } else if (li?.link && isInternalLink(li.link, Link)) {\r\n      return (\r\n        <Link to={li.link.href} target={li.link.target} title={li.link.title} className={styles.link}>\r\n          <MoviePoster {...li.image} />\r\n        </Link>\r\n      )\r\n    }\r\n\r\n    return <MoviePoster {...li.image} />\r\n  }\r\n\r\n  return (\r\n    <section>\r\n      {heading && <h1 className={`headingS ${styles.heading} ${preamble ? styles.noMarginBottom : ''}`}>{heading}</h1>}\r\n      {preamble && React.isValidElement(preamble) ? <div className={styles.preambleReactNode}>{preamble}</div> : <p className={styles.preamble}>{preamble}</p>}\r\n      <ul ref={listRef} className={styles.list}>\r\n        {list.map((li: IMoviePosterListItem, i: number) => (\r\n          <li key={i} className={styles.listItem}>\r\n            {renderMoviePoster(li)}\r\n            {li.heading && <p className={`body bold ${styles.listItemHeading}`}>{li.heading}</p>}\r\n            {li.preamble && <p className={`bodyS ${styles.listItemPreamble}`}>{li.preamble}</p>}\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </section>\r\n  )\r\n}\r\n\r\nexport { MoviePosterList }\r\n","import React from 'react';\nimport { ComponentStory, ComponentMeta } from '@storybook/react';\nimport { MoviePosterList, IMoviePosterListItem } from './movie-poster-list';\nexport default ({\n  title: 'Design System/Molecules/MoviePosterList',\n  component: MoviePosterList\n} as ComponentMeta<typeof MoviePosterList>);\nconst Template: ComponentStory<typeof MoviePosterList> = args => {\n  let moviePosterList = [];\n  const headings = ['The Assassination of Jesse James by the Coward Robert Ford', 'The Silence of the Lambs', 'Titanic', 'Jurassic Park', 'Pulp Fiction', 'Star Wars'];\n  let picsumId = 1011;\n  for (let i = 0, iMax = 6; i < iMax; i++) {\n    let image = {\n      id: `pictureOne_${i}`,\n      src: `https://picsum.photos/id/${picsumId + i}/480/720`,\n      sources: [{\n        srcset: `https://picsum.photos/id/${picsumId + i}/480/720`\n      }],\n      alt: 'Placholder',\n      loading: 'eager',\n      decoding: 'auto',\n      fetchPriority: 'auto'\n    };\n    moviePosterList.push({\n      image: image,\n      heading: headings[i],\n      preamble: 'Premiär 19 maj'\n    });\n  }\n  let moviePosterListWithHrefs = moviePosterList.map((li: IMoviePosterListItem) => {\n    return {\n      ...li,\n      link: {\n        href: 'https://filmstaden.se',\n        isExternal: true,\n        target: '_blank'\n      }\n    };\n  });\n  return <>\n      <div style={{\n      width: '100%',\n      maxWidth: '1256px',\n      margin: '0 0 5rem 0'\n    }}>\n        <MoviePosterList {...args} list={moviePosterList} heading={'Premiärer i April'} preamble={<p>\n              Se hela vårt utbud på <a href=\"https://www.filmstaden.se\">filmstaden.se</a>\n            </p>} listSessionId={'moviePosterListSessionId_1'} />\n      </div>\n\n      <div style={{\n      width: '100%',\n      maxWidth: '1256px',\n      margin: '0 0 5rem 0'\n    }}>\n        <MoviePosterList {...args} list={moviePosterListWithHrefs} heading={'Lista med länkar'} preamble={'Se hela vårt utbud på filmstaden.se'} listSessionId={'moviePosterListSessionId_2'} />\n      </div>\n    </>;\n};\nexport const MoviePosterListStory = Template.bind({});\nMoviePosterListStory.storyName = 'Movie Poster List';\nMoviePosterListStory.parameters = {\n  ...MoviePosterListStory.parameters,\n  docs: {\n    ...MoviePosterListStory.parameters?.docs,\n    source: {\n      originalSource: \"args => {\\n  let moviePosterList = [];\\n  const headings = ['The Assassination of Jesse James by the Coward Robert Ford', 'The Silence of the Lambs', 'Titanic', 'Jurassic Park', 'Pulp Fiction', 'Star Wars'];\\n  let picsumId = 1011;\\n  for (let i = 0, iMax = 6; i < iMax; i++) {\\n    let image = {\\n      id: `pictureOne_${i}`,\\n      src: `https://picsum.photos/id/${picsumId + i}/480/720`,\\n      sources: [{\\n        srcset: `https://picsum.photos/id/${picsumId + i}/480/720`\\n      }],\\n      alt: 'Placholder',\\n      loading: 'eager',\\n      decoding: 'auto',\\n      fetchPriority: 'auto'\\n    };\\n    moviePosterList.push({\\n      image: image,\\n      heading: headings[i],\\n      preamble: 'Premi\\xE4r 19 maj'\\n    });\\n  }\\n  let moviePosterListWithHrefs = moviePosterList.map((li: IMoviePosterListItem) => {\\n    return {\\n      ...li,\\n      link: {\\n        href: 'https://filmstaden.se',\\n        isExternal: true,\\n        target: '_blank'\\n      }\\n    };\\n  });\\n  return <>\\n      <div style={{\\n      width: '100%',\\n      maxWidth: '1256px',\\n      margin: '0 0 5rem 0'\\n    }}>\\n        <MoviePosterList {...args} list={moviePosterList} heading={'Premi\\xE4rer i April'} preamble={<p>\\n              Se hela v\\xE5rt utbud p\\xE5 <a href=\\\"https://www.filmstaden.se\\\">filmstaden.se</a>\\n            </p>} listSessionId={'moviePosterListSessionId_1'} />\\n      </div>\\n\\n      <div style={{\\n      width: '100%',\\n      maxWidth: '1256px',\\n      margin: '0 0 5rem 0'\\n    }}>\\n        <MoviePosterList {...args} list={moviePosterListWithHrefs} heading={'Lista med l\\xE4nkar'} preamble={'Se hela v\\xE5rt utbud p\\xE5 filmstaden.se'} listSessionId={'moviePosterListSessionId_2'} />\\n      </div>\\n    </>;\\n}\",\n      ...MoviePosterListStory.parameters?.docs?.source\n    }\n  }\n};"],"names":["useScrollLeft","ref","initialPosition","scrollPosition","setPosition","useState","useLayoutEffect","updatePosition","isExternalLink","link","isInternalLink","linkComponent","setItemSessionStorage","key","value","timestamp","isTimeStampValid","now","getItemSessionStorage","valueTimeStampValidation","removeItemSessionStorage","getInitialScrollLeft","sessionStorageId","scrollLeftPosition","MoviePosterList","heading","preamble","Link","listRef","useRef","scrollLeft","listSessionId","useEffect","renderMoviePoster","li","_jsx","href","target","title","image","MoviePoster","_jsxs","styles","preambleReactNode","list","listItem","listItemHeading","listItemPreamble","i","moviePosterList_stories","component","Template","args","moviePosterList","headings","picsumId","iMax","id","src","sources","srcset","alt","loading","decoding","fetchPriority","push","moviePosterListWithHrefs","map","isExternal","_Fragment","children","style","width","maxWidth","margin","MoviePosterListStory","bind","storyName","parameters","docs","source","originalSource"],"mappings":"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"}